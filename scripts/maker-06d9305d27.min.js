"use strict";var modulArray=["http://bmob-cdn-24377.b0.upaiyun.com/2019/03/26/aca3100840d4f63580d8cf26bd5ea2a9.png","http://bmob-cdn-24377.b0.upaiyun.com/2019/03/26/f5c181d440bb368b80526c27e394a0c3.png","http://bmob-cdn-24377.b0.upaiyun.com/2019/03/26/cd600b9c40d3908b80232e0f16b71200.png","http://bmob-cdn-24377.b0.upaiyun.com/2019/03/26/48f4c317406c7cc08079ee474d8621fa.png","http://bmob-cdn-24377.b0.upaiyun.com/2019/03/26/87165b22405941cf80382cab8f84dc3d.png","http://bmob-cdn-24377.b0.upaiyun.com/2019/03/26/38dd906440c80b03809c60366a9e3e70.png"];function getQueryString(e){var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(o);return null!=t?unescape(t[2]):null}$(".downZone").height($(window).height()-$(".acZone").height());var file=document.querySelector("#file"),ua=navigator.userAgent.toLowerCase();"iphone os"==ua.match(/iPhone\sOS/i)&&file.removeAttribute("capture");var swiper=new Swiper(".swiper-container",{pagination:{el:".swiper-pagination"},autoplay:{delay:3e3,disableOnInteraction:!1}});$(".home button").click(function(){$(".home footer").show()}),$(".home footer div").on("click","div",function(){var e=$(this).index();switch(console.log(e),e){case 0:$(".home").hide(),$(".maker").show(),$("#file").click();break;case 1:$(".home").hide(),$(".maker").show(),$("#file").removeAttr("capture accept"),$("#file").click();break;case 2:$(".home footer").hide()}}),$(document).on("click",".selectZone ul li",function(){var e=$(this).index();$(".acZone .bgBox img").attr("src",modulArray[e]),$(this).hasClass("active")||($(this).addClass("active").append('<img class="markPic" src="images/active.png" alt="">'),$(this).siblings().removeClass("active").find(".markPic").remove())}),$(".overlay button").on("click",function(){$("#isEnter").hasClass("cropper-hidden")?$(".overlay").fadeOut():($(".trueSelect").show(),setTimeout(function(){window.location.reload()},1e3))}),$(".repeatSel").click(function(){$("#file").removeAttr("capture"),$("#file").attr("accept","image/*"),$("#file").click()}),$(".makeDo").click(function(){$(".loading").show(),$("#qrcode").show(),makeDo(),setTimeout(function(){$(".loading").hide()},3e3)});var croppable=!1;function iniCropper(){var e=$(".js-image");e[0];e.cropper({dragMode:"move",aspectRatio:75/85,autoCropArea:1,restore:!1,viewMode:0,guides:!1,center:!1,preview:".copylay",highlight:!1,cropBoxMovable:!1,cropBoxResizable:!1,toggleDragModeOnDblclick:!1,rotatable:!0,checkOrientation:!0,background:!1,ready:function(){croppable=!0}})}function makeDo(){var e=$(".acZone")[0],o=e.offsetWidth,t=e.offsetHeight,a=document.createElement("canvas");a.width=2*o,a.height=2*t,a.getContext("2d").scale(2,2),html2canvas(e,{scale:2,canvas:a,width:o,height:t,useCORS:!0}).then(function(e){var o=e.getContext("2d");o.mozImageSmoothingEnabled=!1,o.webkitImageSmoothingEnabled=!1,o.msImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1;var t=Canvas2Image.convertToJPEG(e,e.width,e.height);$(".maker").hide(),$(".share").show().prepend(t),$(t).css({width:e.width/2+"px",height:e.height/2+"px"})})}function dataURLtoFile(e,o){for(var t=e.split(","),a=t[0].match(/:(.*?);/)[1],i=atob(t[1]),n=i.length,c=new Uint8Array(n);n--;)c[n]=i.charCodeAt(n);return new File([c],o,{type:a})}function fileup(e){document.forms[0];var o=new FormData;o.append("myfile",dataURLtoFile(e,"123.png")),o.append("name","111"),o.append("sex","0"),o.append("employeeId","111"),o.append("idCard","111"),o.append("phoneNumber","1111"),o.append("facesetToken","1111"),$.ajax({url:"",type:"POST",data:o,async:!1,cache:!1,contentType:!1,processData:!1,beforeSend:function(e){e.setRequestHeader("User-Agent","Mozilla")},success:function(e){console.log(e),$(".loading").hide(),$("#qrcode").hide()},error:function(e){console.log("上传失败，请重新上传"),window.location.reload()}})}$("#file").on("change",function(){console.log(this),console.log(this.files[0]);var e=new FileReader,o=this.files[0];e.readAsDataURL(o),e.onload=function(){$(".js-image").attr("src",e.result),croppable?($(".js-image").cropper("reset"),$(".js-image").cropper("replace",e.result)):iniCropper()}});var qrcode=new QRCode("qrcode",{width:$("#qrcode").width(),height:$("#qrcode").height(),text:"暂不做链接展示",colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});